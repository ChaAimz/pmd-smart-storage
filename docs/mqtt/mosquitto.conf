# ============================================================
# Mosquitto MQTT Broker Configuration
# Smart Storage System - Development Configuration
# ============================================================

# ------------------------------------------------------------
# Network Configuration
# ------------------------------------------------------------

# Listen on default MQTT port
listener 1883 0.0.0.0

# Protocol
protocol mqtt

# ------------------------------------------------------------
# Authentication (Development Mode)
# ------------------------------------------------------------

# Allow anonymous connections for development
# WARNING: Set to false in production!
allow_anonymous true

# For production, uncomment and configure:
# allow_anonymous false
# password_file C:/Program Files/mosquitto/passwords.txt

# ------------------------------------------------------------
# Persistence
# ------------------------------------------------------------

# Enable message persistence
persistence true

# Persistence database location
# Windows path - adjust if needed
persistence_location C:/Program Files/mosquitto/data/

# Autosave interval (seconds)
autosave_interval 300

# Persistence file name
persistence_file mosquitto.db

# ------------------------------------------------------------
# Logging
# ------------------------------------------------------------

# Log to file and console
log_dest file C:/Program Files/mosquitto/logs/mosquitto.log
log_dest stdout

# Log types
log_type error
log_type warning
log_type notice
log_type information

# Timestamp format
log_timestamp true
log_timestamp_format %Y-%m-%dT%H:%M:%S

# Connection messages
connection_messages true

# ------------------------------------------------------------
# Connection Limits
# ------------------------------------------------------------

# Maximum simultaneous client connections (-1 = unlimited)
max_connections -1

# Maximum queued messages per client
max_queued_messages 1000

# Maximum QoS 1 and 2 messages in flight
max_inflight_messages 20

# ------------------------------------------------------------
# Message Settings
# ------------------------------------------------------------

# Maximum packet size (10MB)
max_packet_size 10485760

# Retain available
retain_available true

# ------------------------------------------------------------
# Keep Alive
# ------------------------------------------------------------

# Maximum keep alive time (seconds)
max_keepalive 65535

# ------------------------------------------------------------
# Quality of Service
# ------------------------------------------------------------

# Allow QoS 0, 1, and 2
max_qos 2

# Upgrade QoS if needed
upgrade_outgoing_qos false

# ------------------------------------------------------------
# Client Settings
# ------------------------------------------------------------

# Allow clients to set their own client ID
allow_duplicate_messages false

# Persistent client expiration (7 days)
persistent_client_expiration 7d

# ------------------------------------------------------------
# Security (Optional - for production)
# ------------------------------------------------------------

# TLS/SSL Configuration (uncomment for secure connections)
# listener 8883
# cafile C:/Program Files/mosquitto/certs/ca.crt
# certfile C:/Program Files/mosquitto/certs/server.crt
# keyfile C:/Program Files/mosquitto/certs/server.key
# require_certificate false

# ------------------------------------------------------------
# Bridge Configuration (Optional)
# ------------------------------------------------------------

# Use this to bridge to cloud MQTT brokers
# connection bridge-to-cloud
# address cloud.mqtt.broker:1883
# topic smart-storage/# out 0
# topic smart-storage/# in 0

# ------------------------------------------------------------
# Websockets (Optional - for web clients)
# ------------------------------------------------------------

# Uncomment to enable WebSocket support
# listener 9001
# protocol websockets

# ------------------------------------------------------------
# Performance Tuning
# ------------------------------------------------------------

# Queue QoS 0 messages
queue_qos0_messages false

# Memory limit (bytes, 0 = unlimited)
memory_limit 0

# ------------------------------------------------------------
# Smart Storage Specific Settings
# ------------------------------------------------------------

# Topics used by the system:
# - smart-storage/status    (gateway status)
# - smart-storage/button    (button press events)
# - smart-storage/command   (LED control commands)

# ACL file for topic-based access control (optional)
# acl_file C:/Program Files/mosquitto/acl.conf

